<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Garagem Conectada</title>
    <link rel="stylesheet" href="css/auth.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-box">
            <div class="auth-header">
                <div class="logo">P</div>
                <h1>Bem-vindo de volta!</h1>
                <p>Faça login para acessar o sistema</p>
            </div>

            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <input type="email" id="email" name="email" placeholder="E-mail" required>
                </div>

                <div class="form-group">
                    <input type="password" id="password" name="password" placeholder="Senha" required>
                </div>

                <button type="submit" class="btn-login">Entrar</button>
            </form>

            <div class="auth-footer">
                <p>Não tem uma conta? <a href="register.html">Registre-se</a></p>
            </div>
        </div>
    </div>

    <div id="notifications"></div>

    <script>
        const loginForm = document.getElementById('loginForm');
        
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch('http://localhost:3000/users/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'Erro ao fazer login');
                }

                // Salva o token e os dados do usuário
                localStorage.setItem('token', data.token);
                localStorage.setItem('user', JSON.stringify(data.user));

                // Mostra mensagem de sucesso
                showNotification('Login realizado com sucesso!', 'success');

                // Redireciona para a página principal
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1000);
            } catch (error) {
                showNotification(error.message, 'error');
            }
        });

        function showNotification(message, type = 'info') {
            const container = document.getElementById('notifications');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            container.appendChild(notification);
            setTimeout(() => notification.remove(), 5000);
        }
    </script>
</body>
</html>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Botão de Login -->
                    <button type="submit" class="btn-primary">
                        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M11 7L9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8v14z"/>
                        </svg>
                        Entrar
                    </button>
                </form>

                <!-- Links -->
                <div class="auth-links">
                    <p>Não tem uma conta? <a href="register.html">Cadastre-se</a></p>
                </div>
            </div>
        </div>
    </div>

    <script src="js/login.js"></script>
</body>
</html>